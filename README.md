Gen-711-final
By: Calvin Demers
Background: The data for this project came from a duckweed pond microbiome study by Alyssa Diagle, and comes in the form of paired end, 250 bp, ilumina reads. The goal of this project is to determine the composition of species within the pond microbiome from the given metagenomic sequencing data, generate phylogeny data, and determine alpha and beta diversity. 
Methods: The analysis was performed via a script.sh file through RON on a laptop computer. The first step of the pipeline uses the simple commands mkdir, cd, cp, and wget to create a directory within the home directory, navigate there automatically, move the metadata, and download an RNA classifier to it. The second step uses "qiime tools import" to get the manifest.tsv file containing the demultiplexed data, into the new directory as a .qza file. Next the "qiime demux summarize" tool was used in order to generate a .qzv visual summary of the demultiplexed data. Next, the dada2 denoising step took the demultiplexed sequences and truncated them by 15 base pairs on the left and 0 bp on the right to remove low quality parts of the reads. The outputs of the denoising step are 3 .qza files, the representative sequences, denoising table, and denoising statistics, which will be used as metadata throughout the rest of the pipeline. The next few steps generate visualizations of the denoising outputs. The qiime metadata tabulate tool was used to generate a visualization of the denoising stats and the qiime feature-table summarize tool was used to generate three visualization files for the feature table artifact, which contain informaton on the number of sequences associated with a particular sample, histograms of those sequences, and some related statistics. The next step consists of two commands, feature-table filter-features and feature-table filter-seqs, which use the summarized table generated in the previous step and filters out all the outlying features and sequences that are only observed in a single sample, outputting artifact files. The next step uses the filtered sequences from the previous steps to create a sequence alignment using mafft and to mask any alignments that are phylogenically unhelpful. The outputs of this step are 4 .qza files containing four versions of the inferred phylogenic trees, one masked and rooted in the middle and one masked and unrooted, along with unmasked versions of these trees. The next step uses the RNA classifier which was downloaded in the first step and the sklearn command to classify reads by taxa and output them as an artifact. The next step requires the q2-boots-amplicon conda environment to be activated, the kmer diversity command will then take the filtered table and filtered seqs and resample them until they have a sampling depth of 96 and outputs the average alpha and beta diversity along with visualizations for each. Next the qiime diversity core-metrics-phylogenetic tool was used to take the filtered table and the rooted tree generated before, and applies diversity metrics to output a directory full of various artifacts and visualization files including a rarefied filtered table, distance matrix, evenness plot, and weighted/unweighted unifrac emporer plots. The last three commands have to do with determining group significance. diversity alpha-group signifcance was run on the faith vector artifact and evenness vector artifact in order to output visualization files for significance of faith and evenness. diversity beta-group significance was run on the unweigheted unifrac artifact to generate a visual unifrac chart. Between most steps in the pipeline, an echo command was used to update the user as to what step is currently being run and when the pipeline fully ends. 
![alpha-compare](https://github.com/user-attachments/assets/e51aaa79-1cef-411e-b754-ab450717e473)
This box plot shows evenness between the species of duckweed and the species in the surrounding water. because the water category has a higher evenness, it can be determined that the abundances of different genotypes are more balanced. It was created by viewing a .qzv file generated during the workflow through the qiime2 viewer. This was an output of the diversity-core metrics phylogenetics step, which required a rooted phylogenetic tree artifact and the filtered table generated in the feature-table step.   
![alpha-compare (1)](https://github.com/user-attachments/assets/f97be0ae-d964-4af2-8c26-d8e8eacf49d1)
This box plot shows faith's phylogenic diversity between the species of duckweed and the species in the surrounding water. because the water category has a higher faith_pd value, it can be determined that the species in the water show greater phylogenetic diversity. It was created by viewing a .qzv file generated during the workflow through the qiime2 viewer. This was an output of the diversity-core metrics phylogenetics step, which required a rooted phylogenetic tree artifact and the filtered table generated in the feature-table step.   
Citations: 
Caporaso, Greg. “Gut-to-Soil Axis Tutorial” Microbiome Marker Gene Analysis with QIIME 2, amplicon-docs.qiime2.org/en/latest/tutorials/gut-to-soil.html. Accessed 11 May 2025. 
Bolyen E, Rideout JR, Dillon MR, Bokulich NA, Abnet CC, Al-Ghalith GA, Alexander H, Alm EJ, Arumugam M, Asnicar F, Bai Y, Bisanz JE, Bittinger K, Brejnrod A, Brislawn CJ, Brown CT, Callahan BJ, Caraballo-Rodríguez AM, Chase J, Cope EK, Da Silva R, Diener C, Dorrestein PC, Douglas GM, Durall DM, Duvallet C, Edwardson CF, Ernst M, Estaki M, Fouquier J, Gauglitz JM, Gibbons SM, Gibson DL, Gonzalez A, Gorlick K, Guo J, Hillmann B, Holmes S, Holste H, Huttenhower C, Huttley GA, Janssen S, Jarmusch AK, Jiang L, Kaehler BD, Kang KB, Keefe CR, Keim P, Kelley ST, Knights D, Koester I, Kosciolek T, Kreps J, Langille MGI, Lee J, Ley R, Liu YX, Loftfield E, Lozupone C, Maher M, Marotz C, Martin BD, McDonald D, McIver LJ, Melnik AV, Metcalf JL, Morgan SC, Morton JT, Naimey AT, Navas-Molina JA, Nothias LF, Orchanian SB, Pearson T, Peoples SL, Petras D, Preuss ML, Pruesse E, Rasmussen LB, Rivers A, Robeson MS, Rosenthal P, Segata N, Shaffer M, Shiffer A, Sinha R, Song SJ, Spear JR, Swafford AD, Thompson LR, Torres PJ, Trinh P, Tripathi A, Turnbaugh PJ, Ul-Hasan S, van der Hooft JJJ, Vargas F, Vázquez-Baeza Y, Vogtmann E, von Hippel M, Walters W, Wan Y, Wang M, Warren J, Weber KC, Williamson CHD, Willis AD, Xu ZZ, Zaneveld JR, Zhang Y, Zhu Q, Knight R, and Caporaso JG. 2019. Reproducible, interactive, scalable and extensible microbiome data science using QIIME 2. Nature Biotechnology 37: 852–857. https://doi.org/10.1038/s41587-019-0209-9
Callahan, B. J., McMurdie, P. J., Rosen, M. J., Han, A. W., Johnson, A. J. A., & Holmes, S. P. (2016). DADA2: high-resolution sample inference from Illumina amplicon data. Nature Methods, 13(7), 581. https://doi.org/10.1038/nmeth.3869
Katoh, K., & Standley, D. M. (2013). MAFFT multiple sequence alignment software version 7: improvements in performance and usability. Molecular Biology and Evolution, 30(4), 772–780. https://doi.org/10.1093/molbev/mst010
Lane, D. (1991). 16S/23S rRNA sequencing. In E. Stackebrandt & M. Goodfellow (Eds.), Nucleic Acid Techniques in Bacterial Systematics (pp. 115–175). John Wiley.
Price, M. N., Dehal, P. S., & Arkin, A. P. (2010). FastTree 2–approximately maximum-likelihood trees for large alignments. PloS One, 5(3), e9490. https://doi.org/10.1371/journal.pone.0009490
Bokulich, N. A., Kaehler, B. D., Rideout, J. R., Dillon, M., Bolyen, E., Knight, R., Huttley, G. A., & Caporaso, J. G. (2018). Optimizing taxonomic classification of marker-gene amplicon sequences with QIIME 2’s q2-feature-classifier plugin. Microbiome, 6(1), 90. https://doi.org/10.1186/s40168-018-0470-z
Pedregosa, F., Varoquaux, G., Gramfort, A., Michel, V., Thirion, B., Grisel, O., Blondel, M., Prettenhofer, P., Weiss, R., Dubourg, V., Vanderplas, J., Passos, A., Cournapeau, D., Brucher, M., Perrot, M., & Duchesnay, É. (2011). Scikit-learn: Machine learning in Python. Journal of Machine Learning Research, 12(Oct), 2825–2830.
Wes McKinney. (2010). Data Structures for Statistical Computing in Python . In S. van der Walt & Jarrod Millman (Eds.), Proceedings of the 9th Python in Science Conference (pp. 51–56).
